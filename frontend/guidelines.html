<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Personalized Guidelines | Ikigai</title>

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Arial, sans-serif;
      background: linear-gradient(135deg, #f0fdf4, #eef2ff);
      min-height: 100vh;
      padding: 30px;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 35px;
      border-radius: 18px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.12);
    }

    h1 {
      text-align: center;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      color: #555;
      margin-bottom: 30px;
    }

    .section {
      margin-bottom: 30px;
    }

    .card {
      background: #ecfeff;
      border-left: 6px solid #16a34a;
      padding: 18px;
      border-radius: 12px;
      margin-bottom: 15px;
      line-height: 1.7;
    }

    .warning {
      background: #fff7ed;
      border-left-color: #f97316;
    }

    .danger {
      background: #fef2f2;
      border-left-color: #dc2626;
    }

    .tag {
      font-weight: bold;
      margin-bottom: 6px;
    }

    button {
      display: block;
      margin: 30px auto 0;
      padding: 14px 28px;
      font-size: 16px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, #4f46e5, #16a34a);
      color: white;
      font-weight: bold;
    }

    button:hover {
      opacity: 0.9;
    }

    .note {
      margin-top: 30px;
      font-size: 13px;
      color: #666;
      text-align: center;
    }
  </style>
</head>

<body>

<div class="container">
  <h1>ğŸŒ¿ Your Personalized Ikigai Guidelines</h1>
  <p class="subtitle">
    Based on your recent habits, stress level, and Ikigai balance
  </p>

  <div id="guidelines"></div>

  <button onclick="goHome()">ğŸ  Back to Dashboard</button>

  <div class="note">
    âš  These suggestions are for awareness and preventive well-being only.
  </div>
</div>

<script>
/* ğŸ”’ AUTH CHECK */
const currentUser = JSON.parse(localStorage.getItem("ikigai_current_user"));
if (!currentUser) {
  window.location.href = "login.html";
}

/* ğŸ“¥ LOAD LAST RESULT */
const last = JSON.parse(localStorage.getItem("ikigai_last_result"));
if (!last) {
  alert("No analysis found. Please analyze first.");
  window.location.href = "index.html";
}

const stress = last.result.layer3_ml_support.final_stress_level;
const ikigaiScore = last.result.layer3_ikigai.ikigai_score;

let html = "";

/* ğŸ§  STRESS-BASED GUIDELINES */
html += `<div class="section">
  <h3>ğŸ§  Stress-Level Guidance</h3>`;

if (stress === "High") {
  html += `
    <div class="card danger">
      <div class="tag">ğŸš¨ High Stress Detected</div>
      â€¢ Reduce screen exposure, especially at night<br>
      â€¢ Ensure at least 7 hours of sleep<br>
      â€¢ Take short breaks between study sessions<br>
      â€¢ Talk to someone you trust
    </div>`;
} 
else if (stress === "Medium") {
  html += `
    <div class="card warning">
      <div class="tag">âš  Moderate Stress</div>
      â€¢ Maintain consistent sleep timings<br>
      â€¢ Balance study with physical activity<br>
      â€¢ Limit late-night phone usage
    </div>`;
} 
else {
  html += `
    <div class="card">
      <div class="tag">âœ… Low Stress</div>
      â€¢ Your routine looks balanced<br>
      â€¢ Continue healthy habits<br>
      â€¢ Avoid overworking to maintain balance
    </div>`;
}

html += `</div>`;

/* ğŸŒ¸ IKIGAI SCORE GUIDANCE */
html += `<div class="section">
  <h3>ğŸŒ¸ Ikigai Balance Suggestions</h3>`;

if (ikigaiScore < 50) {
  html += `
    <div class="card danger">
      â€¢ Your balance is currently low<br>
      â€¢ Focus on rest and emotional well-being<br>
      â€¢ Reduce workload temporarily
    </div>`;
}
else if (ikigaiScore < 75) {
  html += `
    <div class="card warning">
      â€¢ You're moderately balanced<br>
      â€¢ Small improvements in sleep & activity can help<br>
      â€¢ Schedule time for things you enjoy
    </div>`;
}
else {
  html += `
    <div class="card">
      â€¢ Excellent balance ğŸŒŸ<br>
      â€¢ You're aligning productivity with well-being<br>
      â€¢ Keep reflecting weekly to stay consistent
    </div>`;
}

html += `</div>`;

/* ğŸ¯ HABIT-SPECIFIC TIPS */
html += `
<div class="section">
  <h3>ğŸ¯ Habit Improvement Tips</h3>
  <div class="card">
    ğŸ›Œ Sleep: Maintain fixed sleepâ€“wake times<br>
    ğŸ“± Screen: Take a 10-minute break every hour<br>
    ğŸƒ Activity: Even light movement helps mental clarity<br>
    ğŸ˜Œ Mood: Journaling or mindfulness boosts emotional awareness
  </div>
</div>
`;

document.getElementById("guidelines").innerHTML = html;

function goHome() {
  window.location.href = "home.html";
}
</script>

</body>
</html>
